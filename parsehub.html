<!DOCTYPE html>
<html lang="en">
	<meta http-equiv="Cache-Control" content="no-store" />
	<head>
	  <meta charset="utf-8">
	  <title>ParseHub Web Data Connector for Tableau by The Information Lab</title>
	  <meta name="application-name" content="ParseHub Web Data Connector for Tableau by The Information Lab">
	  <meta name="author" content="The Information Lab">
		<meta name="description" content="ParseHub Web Data Connector for Tableau by The Information Lab">
	  <meta name="viewport" content="width=device-width, initial-scale=1">
	  <link href='http://fonts.googleapis.com/css?family=Raleway:400,300,600' rel='stylesheet' type='text/css'>
	  <link rel="stylesheet" href="css/normalize.css">
	  <link rel="stylesheet" href="css/skeleton.css">
	  <link rel="stylesheet" href="css/main.css">
		<link rel="stylesheet" href="css/connector.css">
	  <link href="css/bootstrap.min.css" rel="stylesheet">
	  <link href="css/font-awesome.min.css" rel="stylesheet">
	  <link href="css/yay.min.css" rel="stylesheet">
		<link href="css/fontcustom.css" rel="stylesheet">
	  <!-- HTML5 shim IE8 support for HTML5 elements -->
	  <!--[if lt IE 9]>
	    <script src="js/html5shiv.min.js"></script>
	  <![endif]-->

	<script src="js/jquery-1.11.1.min.js" type="text/javascript"></script>
	<script src="js/tableauwdc-1.1.0.js" type="text/javascript"></script>

	<script type="text/javascript">

	var myConnector = tableau.makeConnector();
/*
	myConnector.init = function() {
		$('.section-description').html("In just a few clicks, you'll be able to get your Fitbit step, distance, floor counts and more. When you're ready, hit the button below and you'll be asked to give Tableau access to your Fitbit data. Once complete, an extract of your data will be created and you can start vizzing!.</br><a class='button button-primary button-margin' id='letsgo'>Lets go!</a>");
		$('#letsgo').bind('click', function(){
				$('.ajax-loading').show();
				window.location.href = "https://www.fitbit.com/oauth2/authorize?response_type=token&client_id=229M2H&redirect_uri=http://data.theinformationlab.co.uk/fitbit.html&scope=activity%20nutrition%20heartrate%20location%20nutrition%20profile%20settings%20sleep%20social%20weight&expires_in=2592000";
			});
		tableau.initCallback();
	}
*/
	myConnector.setConnection = function(access_token,refresh_token,user_id) {
		var connData = [access_token,refresh_token,user_id];
		tableau.connectionData = JSON.stringify(connData);
		tableau.connectionName = 'ParseHub'; // name the data source. This will be the data source name in Tableau
	};

	myConnector.getColumnHeaders = function() {
		var fieldNames = ["ActivityDate","Steps","Distance","Floors","Calories","Elevation","minutesSedentary","minutesLightlyActive","minutesFairlyActive","minutesVeryActive","BMI","Fat","Weight"];
		var fieldTypes = ["date","int","float","int","int","int","int","int","int","int","float","float","float"];
		tableau.headersCallback(fieldNames, fieldTypes); // tell tableau about the fields and their types
	};

	myConnector.getTableData = function() {


	};

	tableau.registerConnector(myConnector);

	$(document).ready(function() {
			//$('.button').hide();
			$('.project').hide();
			$('#letsgo').bind('click', function(){
				var apiKey = $('input[type=text]').val().trim();
				var connectionUrl = "https://www.parsehub.com/api/v2/projects?api_key=" + apiKey;
				var xhr = $.ajax({
		        url: connectionUrl,
		        dataType: 'json',
		        success: function (data) {
							$('.welcome').hide();
							$('.project').show();
							console.log(data);
						}
					});
			});
	});

	</script>
</head>
<body class="yay-hide">
<div class="full-container">
  <!-- Bootstrap top navbar -->
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">

      <!-- Yay toggle button -->
      <button class="btn btn-default navbar-btn yay-toggle" type="button"><i class="fa fa-bars"></i></button>

      <a class="navbar-brand" href="#"></a>

    </div><!-- /.container-fluid -->
  </nav>
  <!-- /Bootstrap top navbar -->

  <div class="yaybar yay-shrink yay-hide-to-small yay-gestures yay-overlap-content yay-light">
    <div class="nano">
      <div class="nano-content">

        <ul>
					<li class="active">
            <a href="fitbit.html"><i class="icon-fitbit" style="font-size:22px"></i>Fitbit</a>
          </li>
					<li>
						<a href="strava.html"><i class="icon-strava" style="font-size:22px"></i>Strava</a>
					</li>
					<li>
						<a href="moves.html"><i class="icon-Moves" style="font-size:22px"></i>Moves</a>
					</li>
					<li>
						<a href="quandl.html"><i class="icon-quandl" style="font-size:22px"></i>Quandl</a>
					</li>
					<li>
						<a href="directions.html"><i class="icon-Mapbox" style="font-size:22px"></i>ParseHub</a>
					</li>
					<li>
						<a href="directions.html"><i class="icon-Mapbox" style="font-size:22px"></i>Mapbox Directions</a>
					</li>
					<li class="label">Created by The Information Lab</li>
        </ul>

      </div>
    </div>
  </div>
  <!-- /Yay Sidebar -->
<div class="content-wrap">
<div class='ajax-loading' id='loadingDiv'> </div>
 <div class="section welcome">
 		 <div class="tableauContainer ">
 				<h4 class="section-heading centre">Welcome to the ParseHub Web Data Connector for Tableau</h4>
 				<p class="centre"> <img src="images/parsehub.png" alt="parsehub" style="width:450px;height:100px;"> </p>
 				<p class="section-description centre">Please enter your ParseHub API Key<br><input type="text" id="apiKey"></input></br><a class='button button-primary button-margin' id='letsgo'>Lets go!</a></p>
 				<p class="section-logo centre"><a href="http://www.theinformationlab.co.uk"><img src="images/logo.png" alt="fitbit" style="width:188px;height:75px;"></a></p>
 		 </div>
 </div>
 <div class="section project">
 		 <div class="tableauContainer ">
 				<h4 class="section-heading centre">Welcome to the ParseHub Web Data Connector for Tableau</h4>
 				<p class="centre"> <img src="images/parsehub.png" alt="parsehub" style="width:450px;height:100px;"> </p>
 				<p class="section-description centre">Please enter your ParseHub API Key<br><input type="text" id="apiKey"></input></br><a class='button button-primary button-margin' id='letsgo'>Lets go!</a></p>
 				<p class="section-logo centre"><a href="http://www.theinformationlab.co.uk"><img src="images/logo.png" alt="fitbit" style="width:188px;height:75px;"></a></p>
 		 </div>
 </div>
 </div>
</div>
 <script src="js/jquery-1.11.1.min.js"></script>
 <script src="js/bootstrap.min.js"></script>
 <script src="js/jquery.nanoscroller.min.js"></script>
 <script src="js/yay.min.js"></script>

</body>
</html>
